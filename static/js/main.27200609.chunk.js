(this.webpackJsonpcocosoco=this.webpackJsonpcocosoco||[]).push([[0],{65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),i=n.n(r),o=n(10),c=n.n(o),s=n(8),u=n(13),l=n(28),d=n(23),p=n(29),f=n(16),m=n(7),b=n.n(m),v=n(9),j=n(30),h=n.n(j),g=n(31),O=-1,y=null;function I(){return k.apply(this,arguments)}function k(){return(k=Object(v.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"videoinput"===e.kind})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return P.apply(this,arguments)}function P(){return(P=Object(v.a)(b.a.mark((function e(){var t,n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y&&y.getTracks().forEach((function(e){e.stop()})),e.next=3,I();case 3:return t=e.sent,n=O===t.length-1?0:O+1,a=t[n],r={exact:a.deviceId},O=n,e.next=10,navigator.mediaDevices.getUserMedia({audio:!0,video:{deviceId:r}});case 10:return y=e.sent,e.abrupt("return",y);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=Object(g.actionCreatorFactory)(),C=x("ADD_PEER"),M=x.async("ADD_POINTING"),w=x.async("PARTICIPATE"),E=x("REMOVE_PEER"),_=x("REMOVE_POINTING"),N=x.async("SELECT_PEER"),T=x.async("SET_POINTING"),R=x.async("SET_TRANSFORM"),S=x.async("SWITCH_CAMERA"),D=x.async("TOGGLE_AUDIO_MUTING"),L=x.async("TOGGLE_CAMERA_MUTING"),Z=x.async("TOGGLE_MAP_MUTING"),G=x.async("INITIALIZE_MAP"),V=x("ON_MAP_LOCATION_CHANGED"),W=x("ON_PEER_SELECTED"),J=x("ON_TRANSFORM_CHANGED"),F=new Map;function U(e,t,n){return function(){var a=Object(v.a)(b.a.mark((function a(r){var i,o;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i={peerId:e,x:t,y:n};try{r(M.started(i)),clearTimeout(F.get(e)),o=setTimeout((function(){return r(_({peerId:e}))}),4e3),F.set(e,o),r(M.done({result:i,params:i}))}catch(c){r(M.failed({error:c,params:i}))}case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}function Q(){return function(){var e=Object(v.a)(b.a.mark((function e(t,n){var a,r,i,o,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={};try{t(Z.started(a)),i=null===(r=n())||void 0===r?void 0:r.state,o=!(null===i||void 0===i?void 0:i.isMapEnabled),c={isEnabled:o},t(Z.done({result:c,params:a}))}catch(s){t(Z.failed({error:s,params:a}))}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function X(e){return function(){var t=Object(v.a)(b.a.mark((function t(n,a){var r,i,o,c,s,u;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},t.prev=1,n(G.started(r)),i=12,t.next=6,new Promise((function(e){return navigator.geolocation.getCurrentPosition((function(t){e({lat:t.coords.latitude,lng:t.coords.longitude})}))}));case 6:o=t.sent,c=o.lat,s=o.lng,navigator.geolocation.watchPosition((function(e){var t,r,i,o,c=null===(t=a())||void 0===t?void 0:t.state;c&&((null===(r=c.presenter)||void 0===r?void 0:r.peerId)===(null===(i=c.localPeer)||void 0===i?void 0:i.id)&&(null===(o=c.room)||void 0===o||o.send({type:"location-changed",lat:e.coords.latitude,lng:e.coords.longitude}),n(V({lat:e.coords.latitude,lng:e.coords.longitude}))))})),u={key:e,lat:c,lng:s,defaultZoom:i},n(G.done({result:u,params:r})),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),n(G.failed({error:t.t0,params:r}));case 17:case"end":return t.stop()}}),t,null,[[1,14]])})));return function(e,n){return t.apply(this,arguments)}}()}function H(e,t,n){var a;(e(C({peerId:n.peerId,stream:n})),t.state.presenter)&&(null===(a=t.state.room)||void 0===a||a.send({type:"peer-selected",peerId:t.state.presenter.peerId}))}function K(e,t){switch(t.type){case"location-changed":e(V({lat:t.lat,lng:t.lng}));break;case"peer-selected":e(W({peerId:t.peerId}));break;case"pointing-added":e(U(t.peerId,t.x,t.y));break;case"transform-changed":e(J({x:t.x,y:t.y,scale:t.scale}))}}var B={audiences:[],isAudioEnabled:!0,isCameraEnabled:!0,isMapEnabled:!0,pointings:[],transform:{x:0,y:0,scale:1}},Y=Object(p.reducerWithInitialState)(B).case(C,(function(e,t){var n=t.peerId,a={peerId:n,stream:t.stream},r=[].concat(Object(d.a)(e.audiences),[a]),i=e._selectedPeerId===n?a:e.presenter,o=i===e.presenter?e.transform:B.transform;return Object.assign({},e,{audiences:r,presenter:i,transform:o})})).case(M.done,(function(e,t){var n=t.result,a=n.peerId,r=n.x,i=n.y,o=e.pointings.filter((function(e){return e.audience.peerId!==a})),c=e.audiences.find((function(e){return e.peerId===a}));return Object.assign({},e,{pointings:[].concat(Object(d.a)(o),[{audience:c,x:r,y:i}])})})).case(w.done,(function(e,t){var n=t.result,a=n.localPeer,r=n.localStream,i=n.room,o=[{peerId:a.id,stream:r}];return Object.assign({},e,{audiences:o,localPeer:a,localStream:r,room:i})})).case(E,(function(e,t){var n,a=t.peerId,r=e.audiences.filter((function(e){return e.peerId!==a})),i=(null===(n=e.presenter)||void 0===n?void 0:n.peerId)===a?null:e.presenter;return Object.assign({},e,{audiences:r,presenter:i})})).case(_,(function(e,t){var n=t.peerId,a=e.pointings.filter((function(e){return e.audience.peerId!==n}));return Object.assign({},e,{pointings:a})})).case(S.done,(function(e,t){var n,a,r=t.result.localStream,i=null===(n=e.localPeer)||void 0===n?void 0:n.id,o=e.audiences.map((function(e){return e.peerId===i?{peerId:i,stream:r}:e})),c=(null===(a=e.presenter)||void 0===a?void 0:a.peerId)===i?{peerId:i,stream:r}:e.presenter;return Object.assign({},e,{audiences:o,localStream:r,presenter:c})})).case(D.done,(function(e,t){var n=t.result.isEnabled;return Object.assign({},e,{isAudioEnabled:n})})).case(L.done,(function(e,t){var n=t.result.isEnabled;return Object.assign({},e,{isCameraEnabled:n})})).case(Z.done,(function(e,t){var n=t.result.isEnabled;return Object.assign({},e,{isMapEnabled:n})})).case(V,(function(e,t){var n=t.lat,a=t.lng;return Object.assign({},e,{map:Object.assign({},e.map,{lat:n,lng:a})})})).case(W,(function(e,t){var n=t.peerId,a=e.audiences.find((function(e){return e.peerId===n}));return Object.assign({},e,{presenter:a,transform:B.transform,_selectedPeerId:n})})).case(G.done,(function(e,t){var n=t.result,a=n.key,r=n.lat,i=n.lng,o=n.defaultZoom;return Object.assign({},e,{map:{key:a,lat:r,lng:i,defaultZoom:o}})})).case(J,(function(e,t){var n=t.x,a=t.y,r=t.scale;return Object.assign({},e,{transform:{x:n,y:a,scale:r}})})),q=Object(u.d)(Object(u.c)({state:Y}),{},Object(u.a)(l.a)),z=n(3),$=n(4),ee=n(6),te=n(5),ne=n(11),ae=(n(65),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(e){var a;Object(z.a)(this,n),(a=t.call(this,e))._onClick=a._onClick.bind(Object(ne.a)(a));var r=new URL(document.URL),i=r.searchParams.get("key"),o=r.searchParams.get("mapkey"),c=r.searchParams.get("network"),s=r.searchParams.get("room"),u=null;return i&&c&&s?"sfu"!==c&&"mesh"!==c?u="Network should be 'sfu' or 'mesh'":o||(u="No specific GoogleMapAPIkey"):u="No specific key, network or room",a.state={key:i,mapkey:o,network:c,room:s,error:u},a}return Object($.a)(n,[{key:"_onClick",value:function(){var e=this.props,t=e.participate,n=e.InitializeMap,a=this.state,r=a.key,i=a.mapkey,o=a.network,c=a.room;this.setState({isParticipating:!0}),t(r,o,c),n(i)}},{key:"render",value:function(){var e=this.state,t=e.room,n=e.error,r=e.isParticipating;return Object(a.jsx)("section",{className:"participation",children:n?Object(a.jsx)("label",{className:"participation__error",children:n}):Object(a.jsxs)("button",{className:"participation__button",onClick:this._onClick,disabled:r,children:[Object(a.jsx)("label",{children:"participate to "}),Object(a.jsx)("label",{className:"participation__room",children:t})]})})}}]),n}(i.a.PureComponent)),re=Object(s.b)(null,(function(e){return{participate:function(t,n,a){e(function(e,t,n){return function(){var a=Object(v.a)(b.a.mark((function a(r,i){var o,c,s,u,l;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o={key:e,network:t,roomId:n},a.prev=1,r(w.started(o)),a.next=5,A();case 5:return c=a.sent,a.next=8,new Promise((function(t){var n=new h.a({key:e});n.on("open",(function(){return t(n)}))}));case 8:s=a.sent,(u=s.joinRoom(n,{mode:t,stream:c})).on("peerLeave",(function(e){return r(E({peerId:e}))})),u.on("stream",(function(e){return H(r,i(),e)})),u.on("data",(function(e){var t=e.data;return K(r,t)})),l={localPeer:s,localStream:c,room:u},r(w.done({result:l,params:o})),a.next=20;break;case 17:a.prev=17,a.t0=a.catch(1),r(w.failed({error:a.t0,params:o}));case 20:case"end":return a.stop()}}),a,null,[[1,17]])})));return function(e,t){return a.apply(this,arguments)}}()}(t,n,a))},InitializeMap:function(t){e(X(t))}}}))(ae),ie=(n(66),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e))._videoRef=i.a.createRef(),a._onClick=a._onClick.bind(Object(ne.a)(a)),a}return Object($.a)(n,[{key:"_onClick",value:function(){var e=this.props,t=e.audience;(0,e.selectPeer)(t.peerId)}},{key:"_updateVideo",value:function(){var e=this._videoRef.current;if(e){var t=this.props.audience;e.srcObject=t.stream,e.playsInline=!0,e.play()}}},{key:"componentDidMount",value:function(){this._updateVideo()}},{key:"componentDidUpdate",value:function(){this._updateVideo()}},{key:"render",value:function(){var e=this.props,t=e.isMuted,n=e.isSelected;return Object(a.jsx)("li",{className:"audience-item "+(n?"audience-item--selected":""),onClick:this._onClick,children:Object(a.jsx)("video",{className:"audience-item__video",muted:t,ref:this._videoRef})})}}]),n}(i.a.PureComponent)),oe=Object(s.b)(null,(function(e){return{selectPeer:function(t){e(function(e){return function(){var t=Object(v.a)(b.a.mark((function t(n,a){var r,i,o;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r={};try{n(N.started(r)),(o=null===(i=a())||void 0===i?void 0:i.state.room)&&(o.send({type:"peer-selected",peerId:e}),n(W({peerId:e}))),n(N.done({result:{},params:r}))}catch(c){n(N.failed({error:c,params:r}))}case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))(ie),ce=(n(67),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){var e=this.props,t=e.audiences,n=e.localPeer,r=e.presenter;return Object(a.jsx)("ul",{className:"audience-list",children:t.map((function(e){return Object(a.jsx)(oe,{audience:e,isMuted:e.peerId===(null===n||void 0===n?void 0:n.id),isSelected:e.peerId===(null===r||void 0===r?void 0:r.peerId)},e.peerId)}))})}}]),n}(i.a.PureComponent)),se=Object(s.b)((function(e){return{audiences:e.state.audiences,localPeer:e.state.localPeer,presenter:e.state.presenter}}))(ce),ue=n(33),le=(n(68),function(e){var t=e.pinImage;return Object(a.jsx)("img",{src:t,alt:"current position"})}),de=function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){var e=this.props,t=e.isMapEnabled,n=e.map,r=t?"mappanel":"mappanel--disabled";return n?Object(a.jsx)("div",{className:r,children:Object(a.jsx)(ue.a,{bootstrapURLKeys:{key:n.key},center:{lat:n.lat,lng:n.lng},defaultZoom:n.defaultZoom,children:Object(a.jsx)(le,{lat:n.lat,lng:n.lng,pinImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAACQBJREFUSA2NVntQVOcVP3f37t0Hr2VhYdflJSpVI2lVpCgS3x0nTqypRYnNNOkfitU4U50+tGiETtJM22D/MNXRJlZCjQ+sWjLTMdb6hDg0oqYoLthSCAmI6PLaZXfvPm5/58puVkw7/Wbu3rP3O9/5ne+8Bfofq7S0VFtXVxcaY9GvW7euxGZLXWww6mdoBE2GQoqihJVur9/X0vtF/9+OHTvWCN4A8487Oybiy5fwJfkkFXsQ9PJJk7N3pqZais1mM2k0GgqHWR8hSrtcg+R6NHChtb39jfpT9RdZWqyMJ6UTacd/GH+gvHx91Yz8qb/PzMzIwl5Ilv0+rIDX51f8Pn8oIPv9wVAwoNdLWpstPTfZnPRKTm6O92bzrcbW1lalsrJSc+nSJWU8zlPAzLhv374wM/5wc3n1zJn523U6UfF6vZ5AICBpNFrJYDDpDAa9Vq/Xa0VR1IVCIZ0cCCjBQMAdF2fS2222ZXbHBOFG801gXvpK8PGm5v+qdi+//NIPiubOOaTVamQfbicIAnAkbAvU09NDjx71gxTImmolm83O3iZZlvEmr94gSbI/oL32cdOa48dP1mEPx1Wo6M01fLPIwm0jithzJ0/8jSRJBNAQfApQvTIy4qb6+nr67LP7lJ09lbIypoDuo4sXL9Lo6Cgxj0YjGGW/7IuLN9GUvMnVkJ0MUL51RLYKF/uHaVWjTZs2bp85K/8t+NINM8azwIHBQeHPZz6kDes3U8lzJeoNOcgAQmfPnqXTZ07QypUrKD4+XvH7/QJc4IHicc3XP33t4MF3fzd2uShG9MYxGokWS1IpMwaDQR0WsaBzH52jrT/6Kb344ipqbr5O1W+/Tb+oqsKNu2jjxnJ69ZX19BF4oKjAZ0KhoBaLUq2WNWOgFINBUeDdu3ert509e3a20WR8hv2FJbKQtjYnzZ27kBYtXkT79++jl8rK6ODBA1Rb+z719vaSyWQk5DhlOHKpq6uT+Ew4TGIgIJPRqP86GTMcLCyCwXQUmP/wysvLtRsQsmEkKjTW4Lbkcg3Q/OJiug+QiooKKikpoQULFqj8mZmZ1NnZRV7vKBRbTP39j9hShKOaUCiswNxJK5fNSlOZY34iwJGoQ4DExYuiln2IQNGSDK31egN8l0ADAwPqUfbr5cuXVXrrtq00cWIOtbW3U3pauur7YDCgFhaOdI4D+FuvMsf8RIAZR/3s8XvcrDGiU+DqJOkk+NhHIyPDlJKS8vgoQqS4eD4tXbqMumFaXuakJES2BynlBxCbOoxsE+DrMCzg9atMMT8R4Ogn521nj9fr80FTLQIlLOn1lJqaQleuXKH09HTas+e31NTURI2NDXT+/F9paHiEDh8+TBZLCqFYIKfTSQdgPgtXCYiVwfr6y31RgDEiWrmgnVraHjx4MFw0r+iFlFSLA4e44CPKLcjV8zC3mdauXUvz5s0jm91G8+D3Xa+/TkuWLKVTp05TQ+MFKioqUm+L7iEjSMW+vv6PGxouq+kUwWDsKDBrO7aU6dOmJ9nt6d+C+X3QHJfWK6jVwgdHj5AS1lBh4RyaM6eQCmYXwMRmOnnyJNWdPELPP79cLSJQmPPYL5Ag3ftXx69Qt5tZdgwG6l/MQp5p8HCdTtu1a8c/srId6R6PZxTGMCE6FdDC1YarFGcyI/qnQgmFnG2tMKtPtYLRaFQYFAp7UEjiOjo6//3LN389E/KGYmSriE8A4wv/V6Os7Htl6+YWFRyRdGIAZTMIMxn55swDd9DgICIc3JZkC1mtaWxeFRTHRyVJb0CcaBqv/f3bp+pO1UMRHFehHkcwhERNDVpdrBlMotxuud3iyHCIdrttEfJah0hHS5Q1HP3ckxmMG4TJZOLKRuhcAoIpEBcXZ5DloHDrZsv2ox8cO8RCY337GOUrgBmUGzj30ps3bl10ODKCOkkswm0l+I015pjzoyqFABZEDMhIvbBOJ8HEYfHhQ5frrrP95384VMMNgsab+L8C8waDbtiwQdfc3Bxubr5xNc2alphsSZ4PQC/KozExMR7WlLgn6+BXCUYQh4aGfTCKznn33h9rDtdWsByWUV1dHRmd+FN0jfdxZIMDhE2klJV9d8kzM6b9CeZNGhoaofv3+xoBdheYk5gFLnAOu92ZtvT0FcnJSeR2u5V77R2vHjpU8/6YsGjcRITzW4z9E6FPnDiBuiWwptZJUya963BMSEKAUUCWb7+zd/9KfHfh4TKomh5vYUfFTy6kai0LrVar4PPJ+wsKCpquX7/eBlMLeKJBBV51PVW58FVYs2aNap5NWzZ+PzPDkcPDwDAqVEdH95vYd6Hxs8JcBuUxWmn65NPdA65BnsfCmZkTTPOfK9qMffYxp+dTlo0F1mzZskV/4EClkQ9gGSxJSasQUJwqWo/bc622tvY4b9TU1IgQyDnP8xlHunDh3Lkrbo/7L6A1fL3EhIQVaLGpzM8yWTbIaBappi6tLJXqKuvkvXv3xhZzlFxdLqefH73ZNTT0IQ4qe/bsMW7bts3LAseWXFVVZQI9+qDv4RnEwneQAVzBshCcFnx/WF5eORphhrISHlmEP7UwLXd9afXq1S9kZDmK9TqtA6A2TIwp3F3QBj3dnV9c4cNOp/Mps3V2dqpT6XvvHW58483KXgz6dgSgtmLnz2oxeXYFAqG+3r4HTUePHK0H6DBbRWR/rsLKf3baOykpyQ4e8LjKcFvDM4o8pXAo3IMhr52Bu7u7n0qPlpaWyLcutNJOJRy2YyT2ot4XoqgUcoZk52S+9rW8SS5n2z93QP5BcenS5Qu/WTTrtNmcyK0sADAR0wPmJvaCYOIxxjM6yi5QpwCUS/V2rERkwaQhvgVngnvEPejImIAJRDShoKj9mPs6ikzQak1B2CQeCAVCbnFOYf7OnJwsTBeDkCPoeIRFaer1++V7Pq+vBbnb8vnnPZ9gM8hAAFHfTMesMEBVF7S0OH/c3++qQ9rno8Dk6w2GPEkSMxIS4kVmSUtLpWnTJ78lbNpcXp9sNscNDw83IGXu3LnjbEX+dUKoO0bw/0sy+PicNebl5WfPLpwx1ZyQ+GyyxfyNEbc77z93i2IVt7hFLgAAAABJRU5ErkJggg=="})})}):null}}]),n}(i.a.PureComponent),pe=Object(s.b)((function(e){return{isMapEnabled:e.state.isMapEnabled,map:e.state.map}}),(function(e){return{InitializeMap:function(t){e(X(t))},toggleMapMuting:function(){e(Q())}}}))(de),fe=n(22),me=n.p+"static/media/Pointing.404d2612.png",be=(n(69),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){var e;Object(z.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r)))._videoRef=i.a.createRef(),e}return Object($.a)(n,[{key:"_updateVideo",value:function(){var e=this._videoRef.current;if(e){var t=this.props.audience;e.srcObject=t.stream,e.playsInline=!0,e.play()}}},{key:"componentDidMount",value:function(){this._updateVideo()}},{key:"componentDidUpdate",value:function(){this._updateVideo()}},{key:"render",value:function(){var e=this.props,t=e.audience,n=e.x,r=e.y,i=180*e.radian/Math.PI,o=i>0?-1:1,c={left:"".concat(n,"px"),top:"".concat(r,"px"),transform:"translate(-60%, 0%) rotate(".concat(i,"deg) scale(").concat(o,", 1)"),transformOrigin:"60% 0%"},s={transform:"scale(".concat(i>0?-1:1,", 1) rotate(").concat(-i,"deg)"),transformOrigin:"50%"};return Object(a.jsxs)("mark",{className:"pointing",style:c,children:[Object(a.jsx)("img",{className:"pointing__image",src:me,alt:t.peerId}),Object(a.jsx)("div",{className:"pointing__audience",children:Object(a.jsx)("video",{className:"pointing__audience__video",style:s,muted:!0,ref:this._videoRef})})]})}}]),n}(i.a.PureComponent)),ve=(n(70),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(e){var a;return Object(z.a)(this,n),(a=t.call(this,e))._videoRef=i.a.createRef(),a._panStopTimer=0,a._onClick=a._onClick.bind(Object(ne.a)(a)),a._onPanningStop=a._onPanningStop.bind(Object(ne.a)(a)),a._onZoomChange=a._onZoomChange.bind(Object(ne.a)(a)),a}return Object($.a)(n,[{key:"_amIPresenter",value:function(){var e=this.props,t=e.localPeer,n=e.presenter;return!(!t||!n)&&t.id===n.peerId}},{key:"_getVideoArea",value:function(){var e=this._videoRef.current;return null===e||void 0===e?void 0:e.closest(".react-transform-component")}},{key:"_isMobile",value:function(){return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())}},{key:"_onClick",value:function(e){var t=e.target,n=e.layerX,a=e.layerY,r=n/t.clientWidth,i=a/t.clientHeight;this.props.setPointing(r,i)}},{key:"_onPanningStop",value:function(){var e=this;this._panStopTimer=window.setTimeout((function(){var t=e._videoRef.current;if(t){var n=t.closest(".react-transform-element").style.transform.match(/translate\((.*)\) scale\((.*)\)/),a=n[1],r=a.match(/(.*), (.*)/),i=parseFloat(r?r[1]:a),o=parseFloat(r&&3===r.length?r[2]:0),c=parseFloat(n[2]);e._onZoomChange({positionX:i,positionY:o,scale:c})}}),500)}},{key:"_onZoomChange",value:function(e){window.clearTimeout(this._panStopTimer);var t=this._getVideoArea(),n=e.positionX,a=e.positionY,r=e.scale,i=n/t.clientWidth,o=a/t.clientHeight;this.props.setTransform(i,o,r)}},{key:"_renderPointings",value:function(){var e=this._getVideoArea();return e?this.props.pointings.map((function(t){var n=t.audience,r=e.offsetLeft+e.clientWidth*t.x,i=e.offsetTop+e.clientHeight*t.y,o=Math.atan2(t.x-.5,-(t.y-.5));return Object(a.jsx)(be,{audience:n,x:r,y:i,radian:o},n.peerId)})):null}},{key:"componentDidMount",value:function(){var e=this._getVideoArea();if(!e)return null;e.addEventListener("click",this._onClick)}},{key:"componentDidUpdate",value:function(e){var t=this._videoRef.current;if(t){var n=this.props.presenter;e.presenter!==n&&(n?(t.muted=this._amIPresenter(),t.srcObject=n.stream,t.playsInline=!0,t.play()):t.srcObject=null)}}},{key:"render",value:function(){var e=this._getVideoArea(),t=this._amIPresenter()&&this._isMobile()?{onPanningStop:this._onPanningStop,onZoomChange:this._onZoomChange,pan:{disabled:!1}}:{positionX:(null===e||void 0===e?void 0:e.clientWidth)*this.props.transform.x,positionY:(null===e||void 0===e?void 0:e.clientHeight)*this.props.transform.y,scale:this.props.transform.scale,pan:{disabled:!0}};return Object(a.jsxs)("section",{className:"presenter",children:[Object(a.jsx)(fe.b,{onPanning:t.onZoomChange,onPanningStop:t.onPanningStop,onZoomChange:t.onZoomChange,positionX:t.positionX,positionY:t.positionY,scale:t.scale,pan:t.pan,doubleClick:{disabled:!0},children:Object(a.jsx)(fe.a,{children:Object(a.jsx)("video",{className:"presenter__video",ref:this._videoRef})})}),this._renderPointings()]})}}]),n}(i.a.PureComponent)),je=Object(s.b)((function(e){return{localPeer:e.state.localPeer,pointings:e.state.pointings,presenter:e.state.presenter,transform:e.state.transform}}),(function(e){return{setPointing:function(t,n){e(function(e,t){return function(){var n=Object(v.a)(b.a.mark((function n(a,r){var i,o,c,s,u,l;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i={};try{a(T.started(i)),s=null===(o=r())||void 0===o?void 0:o.state,(u=null===(c=s.localPeer)||void 0===c?void 0:c.id)&&(null===(l=s.room)||void 0===l||l.send({type:"pointing-added",peerId:u,x:e,y:t}),a(U(u,e,t))),a(T.done({result:{},params:i}))}catch(d){a(T.failed({error:d,params:i}))}case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}(t,n))},setTransform:function(t,n,a){e(function(e,t,n){return function(){var a=Object(v.a)(b.a.mark((function a(r,i){var o,c,s,u;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o={};try{r(R.started(o)),u=null===(c=i())||void 0===c?void 0:c.state,null===(s=u.room)||void 0===s||s.send({type:"transform-changed",x:e,y:t,scale:n}),r(R.done({result:{},params:o}))}catch(l){r(R.failed({error:l,params:o}))}case 2:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()}(t,n,a))}}}))(ve),he=n.p+"static/media/AudioMuting.1652404d.svg",ge=n.p+"static/media/AudioMutingDisabled.df4814d2.svg",Oe=(n(71),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){var e=this.props.isAudioEnabled?he:ge;return Object(a.jsx)("button",{onClick:this.props.toggleAudioMuting,className:"audio-muting",children:Object(a.jsx)("img",{src:e,alt:"mute/unmute audio",className:"audio-muting__image"})})}}]),n}(i.a.PureComponent)),ye=Object(s.b)((function(e){return{isAudioEnabled:e.state.isAudioEnabled}}),(function(e){return{toggleAudioMuting:function(){e(function(){var e=Object(v.a)(b.a.mark((function e(t,n){var a,r,i,o,c,s,u,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={};try{t(D.started(a)),i=null===(r=n())||void 0===r?void 0:r.state,o=!(null===i||void 0===i?void 0:i.isAudioEnabled),c=null===i||void 0===i?void 0:i.localStream,s=Object(f.a)((null===c||void 0===c?void 0:c.getAudioTracks())||[]);try{for(s.s();!(u=s.n()).done;)u.value.enabled=o}catch(d){s.e(d)}finally{s.f()}l={isEnabled:o},t(D.done({result:l,params:a}))}catch(p){t(D.failed({error:p,params:a}))}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}))(Oe),Ie=n.p+"static/media/CameraMuting.e9966563.svg",ke=n.p+"static/media/CameraMutingDisabled.122df4d4.svg",Ae=(n(72),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){var e=this.props.isCameraEnabled?Ie:ke;return Object(a.jsx)("button",{onClick:this.props.toggleCameraMuting,className:"camera-muting",children:Object(a.jsx)("img",{src:e,alt:"mute/unmute camera",className:"camera-muting__image"})})}}]),n}(i.a.PureComponent)),Pe=Object(s.b)((function(e){return{isCameraEnabled:e.state.isCameraEnabled}}),(function(e){return{toggleCameraMuting:function(){e(function(){var e=Object(v.a)(b.a.mark((function e(t,n){var a,r,i,o,c,s,u,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={};try{t(L.started(a)),i=null===(r=n())||void 0===r?void 0:r.state,o=!(null===i||void 0===i?void 0:i.isCameraEnabled),c=null===i||void 0===i?void 0:i.localStream,s=Object(f.a)((null===c||void 0===c?void 0:c.getVideoTracks())||[]);try{for(s.s();!(u=s.n()).done;)u.value.enabled=o}catch(d){s.e(d)}finally{s.f()}l={isEnabled:o},t(L.done({result:l,params:a}))}catch(p){t(L.failed({error:p,params:a}))}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}))(Ae),xe=n.p+"static/media/MapMuting.68798305.svg",Ce=n.p+"static/media/MapMutingDisabled.2c8147b6.svg",Me=(n(73),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){var e=this.props.isMapEnabled?xe:Ce;return Object(a.jsx)("button",{onClick:this.props.toggleMapMuting,className:"map-muting",children:Object(a.jsx)("img",{src:e,alt:"mute/unmute map",className:"map-muting__image"})})}}]),n}(i.a.PureComponent)),we=Object(s.b)((function(e){return{isMapEnabled:e.state.isMapEnabled}}),(function(e){return{toggleMapMuting:function(){e(Q())}}}))(Me),Ee=n.p+"static/media/CameraSwitching.626c7733.svg",_e=(n(74),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){return Object(a.jsx)("button",{onClick:this.props.switchCamera,className:"camera-switching",children:Object(a.jsx)("img",{src:Ee,alt:"switch camera",className:"camera-switching__image"})})}}]),n}(i.a.PureComponent)),Ne=Object(s.b)(null,(function(e){return{switchCamera:function(){e(function(){var e=Object(v.a)(b.a.mark((function e(t,n){var a,r,i,o,c,s,u,l,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={},e.prev=1,t(S.started(a)),c=null===(r=n())||void 0===r?void 0:r.state,s=Object(f.a)((null===c||void 0===c||null===(o=c.localStream)||void 0===o?void 0:o.getTracks())||[]);try{for(s.s();!(u=s.n()).done;)u.value.enabled=!1}catch(p){s.e(p)}finally{s.f()}return e.next=8,A();case 8:l=e.sent,null===c||void 0===c||null===(i=c.room)||void 0===i||i.replaceStream(l),d={localStream:l},t(S.done({result:d,params:a})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),t(S.failed({error:e.t0,params:a}));case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,n){return e.apply(this,arguments)}}())}}}))(_e),Te=(n(75),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){var e=this.props.children;return Object(a.jsx)("li",{className:"tool-item",children:e})}}]),n}(i.a.PureComponent)),Re=(n(76),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("ul",{className:"tool-list",children:[Object(a.jsx)(Te,{children:Object(a.jsx)(Ne,{})}),Object(a.jsx)(Te,{children:Object(a.jsx)(we,{})}),Object(a.jsx)(Te,{children:Object(a.jsx)(Pe,{})}),Object(a.jsx)(Te,{children:Object(a.jsx)(ye,{})})]})}}]),n}(i.a.PureComponent)),Se=(n(77),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("section",{className:"room",children:[Object(a.jsx)(Re,{}),Object(a.jsx)(je,{}),Object(a.jsx)(pe,{}),Object(a.jsx)(se,{})]})}}]),n}(i.a.PureComponent)),De=(n(78),function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){return Object(z.a)(this,n),t.apply(this,arguments)}return Object($.a)(n,[{key:"render",value:function(){return Object(a.jsx)(i.a.Fragment,{children:this.props.room?Object(a.jsx)(Se,{}):Object(a.jsx)(re,{})})}}]),n}(i.a.PureComponent)),Le=Object(s.b)((function(e){return{room:e.state.room}}))(De);n(79);c.a.render(Object(a.jsx)(s.a,{store:q,children:Object(a.jsx)(Le,{})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.27200609.chunk.js.map